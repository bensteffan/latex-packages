\def\filedate{2023/09/18}
\def\fileversion{0.1}

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{bsteffan-math}[\filedate\space Version \fileversion\space by Ben Steffan]

\newif\ifbsteffan@math@english\bsteffan@math@englishtrue
\newif\ifbsteffan@math@topology\bsteffan@math@topologyfalse

\DeclareOption{german}{\bsteffan@math@englishfalse}
\DeclareOption{english}{\bsteffan@math@englishtrue}
\DeclareOption{topology}{\bsteffan@math@topologytrue}

\DeclareOption*{\PackageWarning{bsteffan-math}{Unknown '\CurrentOption'}}
\ProcessOptions\relax

\def\bsteffan@math@langstring{\ifbsteffan@math@english english\else german\fi}

% packages
\RequirePackage{amsmath, amssymb, amsfonts, amsthm}
\RequirePackage{mathabx}
\RequirePackage{mathtools}
\RequirePackage{thmtools}
\RequirePackage{mathrsfs}

% math defs
\newcommand*{\bsteffan@DeclareBilingualOperator}[3]{%
	\expandafter\DeclareMathOperator\csname @bsteffan@mathop@#1\endcsname{#2}
	\expandafter\DeclareMathOperator\csname @@bsteffan@mathop@#1\endcsname{\ifbsteffan@math@english #2\else #3\fi}
	\expandafter\xdef\csname #1\endcsname{\noexpand\@ifstar\expandafter\noexpand\csname @bsteffan@mathop@#1\endcsname\expandafter\noexpand\csname @@bsteffan@mathop@#1\endcsname}
}


\newcommand*{\@DeclareNamedOperatorNoStar}[1]{\expandafter\DeclareMathOperator\csname #1\endcsname{#1}}
\newcommand*{\@DeclareNamedOperatorStar}[1]{%
	% \expandafter will expand the '*' instead of \csname if plugged in directly
	\def\@strop{\DeclareMathOperator*} 
	\expandafter\@strop\csname #1\endcsname{#1}
}

\newcommand{\DeclareNamedOperator}{\@ifstar{\@DeclareNamedOperatorStar}{\@DeclareNamedOperatorNoStar}}

\bsteffan@DeclareBilingualOperator{Img}{Im}{Bild}
\bsteffan@DeclareBilingualOperator{img}{im}{Bild}
\bsteffan@DeclareBilingualOperator{Bild}{Im}{Bild}

\bsteffan@DeclareBilingualOperator{Ker}{Ker}{Kern}
\bsteffan@DeclareBilingualOperator{ker}{ker}{Kern}
\bsteffan@DeclareBilingualOperator{Kern}{Ker}{Kern}
\bsteffan@DeclareBilingualOperator{Coker}{Coker}{Cokern}
\bsteffan@DeclareBilingualOperator{coker}{coker}{Cokern}
\bsteffan@DeclareBilingualOperator{Cokern}{Coker}{Cokern}

\bsteffan@DeclareBilingualOperator{lcm}{lcm}{kgV}
\bsteffan@DeclareBilingualOperator{kgV}{lcm}{kgV}

\bsteffan@DeclareBilingualOperator{gcd}{gcd}{ggT}
\bsteffan@DeclareBilingualOperator{ggT}{gcd}{ggT}

\bsteffan@DeclareBilingualOperator{rank}{rank}{Rang}
\bsteffan@DeclareBilingualOperator{Rang}{rank}{Rang}

\DeclareNamedOperator{Hom}

\DeclareNamedOperator{Tor}
\DeclareNamedOperator{tor}
\DeclareNamedOperator{Ext}
\DeclareNamedOperator{ext}

\DeclareNamedOperator{tors}
\DeclareNamedOperator{free}

\DeclareNamedOperator{End}
\DeclareNamedOperator{Aut}
\DeclareNamedOperator{ord}
\DeclareNamedOperator{sgn}
\DeclareNamedOperator{supp}
\DeclareNamedOperator{tr}
\DeclareNamedOperator{ob}
\DeclareNamedOperator{mor}
\DeclareNamedOperator{dom}
\DeclareNamedOperator{cod}

\DeclareNamedOperator*{colim}

\DeclareNamedOperator{Spec}
\DeclareNamedOperator{MaxSpec}
\DeclareNamedOperator{quot}

\DeclareNamedOperator{Sym}

\newcommand*{\compl}[1]{{#1}^\mathrm{C}}
\newcommand*{\close}[1]{\overline{#1}}

\newcommand*{\catfont}[1]{\symcal{#1}}
\newcommand*{\catfontfixed}[1]{\mathrm{#1}}

\newcommand*{\cat}[1]{\catfont{#1}}
\newcommand*{\catfixed}[1]{\catfontfixed{#1}}

\newcommand*{\DefineCategory}[1]{%
	\expandafter\gdef\csname #1\endcsname{\catfontfixed{#1}}
}

\DefineCategory{AbGrp}
\DefineCategory{Ab}
\DefineCategory{CH}
\DefineCategory{Group}
\DefineCategory{Grp}
\DefineCategory{Mod}
\DefineCategory{Ring}
\DefineCategory{CRing}
\DefineCategory{Set}
\DefineCategory{Vect}
\DefineCategory{Top}

\newcommand*{\op}[1]{#1^{\symrm{op}}}

\newcommand*{\fieldfont}[1]{\symbb{#1}}

\newcommand*{\DefineFieldLike}[1]{%
	\expandafter\gdef\csname #1\endcsname{\fieldfont{#1}}
}

\DefineFieldLike{N}
\DefineFieldLike{Z}
\DefineFieldLike{Q}
\DefineFieldLike{R}
\DefineFieldLike{C}
\DefineFieldLike{F}

\newcommand{\Int}{\Z}
\newcommand{\Zn}[1]{\Z / #1 \Z}

\newcommand{\ideal}[1]{\symfrak{#1}}

% The reason to do it like this is that the single letter names O, U, M, etc. generally have other macro definitions already.
\newcommand*{\DefineLieGroup}[1]{%
	\expandafter\gdef\csname l#1\endcsname{\symrm{#1}}
	\expandafter\xdef\csname la#1\endcsname{\noexpand\mathfrak{\MakeLowercase{#1}}}
}

\DefineLieGroup{M}
\DefineLieGroup{GL}
\DefineLieGroup{SL}
\DefineLieGroup{O}
\DefineLieGroup{U}
\DefineLieGroup{SO}
\DefineLieGroup{SU}

\newcommand{\GL}{\lGL}
\newcommand{\SL}{\lSL}
\newcommand{\Ort}{\lO}
\newcommand{\Uni}{\lU}
\newcommand{\SO}{\lSO}
\newcommand{\SU}{\lSU}

\newcommand{\Torus}{T}
\newcommand{\Sphere}{S}

\newcommand{\pt}{\mathrm{pt.}}

\newcommand{\Tang}{\symrm{T}}
\newcommand{\Norm}{\symrm{N}}

\newcommand{\Trans}{\symrm{T}}

\newcommand{\isom}{\cong}
\newcommand{\incl}{\hookrightarrow}

\newcommand*{\xto}[2][]{\xrightarrow[#1]{#2}}

\newcommand{\mlt}{{\times}}

\newcommand{\id}{\mathrm{id}}
\newcommand{\Id}{\mathrm{Id}}
\newcommand{\pr}{\mathrm{pr}}
\newcommand{\ev}{\mathrm{ev}}
\newcommand{\const}{\mathrm{const}}

\newcommand{\subgrp}{\leq}
\newcommand{\prsubgrp}{<} % "proper subgroup"
\newcommand{\nsubgrp}{\trianglelefteq} % "normal subgroup"
\newcommand{\nprsubgrp}{\vartriangleleft} % "normal proper subgroup"

\newcommand{\indexin}[2]{[#2 : #1]}

\newcommand{\tensor}{\otimes}
\newcommand{\bigtensor}{\bigotimes}
\newcommand{\dsum}{\oplus}
\newcommand{\bigdsum}{\bigoplus}

\newcommand{\di}{\symrm{d}}
\newcommand{\del}{\partial}

\newcommand*{\diff}[2]{\frac{\di #1}{\di #2}}
\newcommand*{\partdiff}[2]{\frac{\del #1}{\del #2}}

\newcommand*{\partdiffop}[1]{\pdiff{}{#1}}

\newcommand*{\atp}[1]{\left.\kern-\nulldelimiterspace#1\right|}

\ifbsteffan@math@topology 
	\RequirePackage[\bsteffan@math@langstring]{bsteffan-topology}
\fi
